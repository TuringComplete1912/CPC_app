# 党务管理系统 - 管理员设置说明

## 数据库配置

✅ 数据库已正确配置为本地 SQLite 文件
- 位置: `prisma/dev.db`
- 配置: `.env` 文件中 `DATABASE_URL="file:./dev.db"`
- 所有党务信息都保存在本地文件中，**不会丢失**

## 管理员设置

系统已配置以下用户为管理员：
- **李明昊**
- **尚冠竹**

### 设置步骤

1. **首次使用 - 用户注册**
   - 启动应用: `npm run dev`
   - 访问: http://localhost:3001
   - 使用用户名 "李明昊" 和 "尚冠竹" 分别注册账号
   - 设置密码（请记住密码）

2. **设置管理员权限**
   ```bash
   npx tsx prisma/set-admins.ts
   ```
   
   此脚本会：
   - 自动将 "李明昊" 和 "尚冠竹" 设置为管理员
   - 显示当前所有管理员列表
   - 确认数据库位置

3. **验证管理员权限**
   - 使用管理员账号登录
   - 访问 "党务管理" 页面
   - 应该能看到 "管理员" 入口并访问管理员页面

## 功能说明

### 普通用户功能 (`/party`)
- 查看和编辑自己的党务信息
- 设置信息公开/隐私
- 查找同年/同阶段同志

### 管理员功能 (`/party/admin`)
- 查看所有用户的党务信息
- 按姓名/年份/发展阶段排序
- 关键字搜索（姓名、班级、政治面貌、籍贯）
- 统计各阶段人数

## 数据持久化

✅ **所有数据都保存在本地 SQLite 数据库中**
- 文件位置: `D:\CPC_app\prisma\dev.db`
- 即使重启应用，数据也不会丢失
- 建议定期备份 `prisma/dev.db` 文件

## 常见问题

### Q: 如何备份数据？
A: 直接复制 `prisma/dev.db` 文件到安全位置

### Q: 如何恢复数据？
A: 将备份的 `dev.db` 文件复制回 `prisma/` 目录

### Q: 如何添加更多管理员？
A: 编辑 `prisma/set-admins.ts` 文件，在 `adminUsernames` 数组中添加用户名，然后运行脚本

### Q: 数据库文件在哪里？
A: `D:\CPC_app\prisma\dev.db` (当前大小: 172KB)

## 技术细节

- 数据库: SQLite (本地文件)
- ORM: Prisma
- 表结构: PartyInfo (包含政治面貌、班级、籍贯、各阶段时间、隐私设置等)
- 关联: 每个用户最多有一条党务信息记录
